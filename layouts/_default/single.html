{{ define "styles" }}
    {{ partial "inside-style.html" . }}
{{ end }}

{{ define "scripts" }}
    {{ partial "inside-scripts.html" . }}

    <script>
      fbq('track', 'ViewContent', {
        content_category: 'Artwork',
        content_name: '{{- .Title -}}',
        content_ids: [{{ range $product := .Params.products }}'{{ $product.id }}',{{ end }}],
        content_type: 'product_group',
        {{ if .Params.products }}
          {{ $first := index (.Params.products) 0 }}
          value: {{ trim $first.price "$" }},
          currency: 'USD',
        {{ end }}
      });
    </script>
{{ end }}

{{ define "main" }}
  {{ $section := .Site.GetPage "section" .Section }}
    <div id="wrapper">
      <!-- Do NOT remove inline styles on bg below -->
      <div class="bg fixed" style='position:fixed; top:0; left:0; z-index:-1; width:100vw; height:100vh; background-color:#ddd; background-image:url("/images/background.webp"); background-size:cover; background-position:center; background-repeat:no-repeat; background-attachment:scroll;'></div>

    {{ block "header" . }}{{ partial "inside-header.html" .}}{{ end }}

    {{ block "nav" . }}{{ partial "inside-navigation.html" .}}{{ end }}

    <div id="main">
        <section class="post">
          {{ if .IsPage }}
            <nav class="breadcrumbs">
              <a href="{{ .Site.BaseURL }}#{{ trim .Title " -" | safeURL }}" class="link blue hover-black">Home</a>
              <span class="mh1">/</span>
              <a href="{{ .CurrentSection.RelPermalink }}#{{ trim .Title " -" | safeURL }}" class="link blue hover-black">{{ .CurrentSection.Title }}</a>
              <span class="mh1">/</span>
              <a href="{{ .RelPermalink }}" class="link blue hover-black">{{ .Title }}</a>
            </nav>
          {{ end }}
            <br>
            <header class="major">
                <h1>{{- .Title -}}</h1>
            </header>

            {{ if .Resources.GetMatch "painting.jpg" }}
              <section style="text-align:center;">
                {{ $full := .Resources.GetMatch "painting.jpg" }}
                {{ $full := $full.Fit "800x800 webp q85" }}

                {{ $top := .Resources.GetMatch "painting.jpg" }}
                {{ $top := $top.Fit "1600x1600 q100" }}

                <a class="painting preview" href="{{ $top.RelPermalink }}" data-gall="progress" data-position="center" style="display:block; border:#000 4px outset; box-shadow:0 0 30px rgba(0, 0, 0, 0.8); padding:0; background:#000; position:relative; z-index:2;" title="{{ .Title }} by {{ .Params.author | default .Site.Params.author }}">
                  <div class="frame" style="border:#111 3vw solid; box-shadow:inset 0 0 30px rgba(0, 0, 0, 1);">
                    <div class="frame-inside" style="border:#000 4px inset; position:relative; z-index:-1;">
                      <div class="mat" style="background:#fff; border:#fff 6vw solid; line-height:0.5em;">
                        <br class="clear" style="clear:both;">
                        
                        <div class="loader" style="background:#000 url('/images/loader.gif') center no-repeat;">
                          <img class="canvas" src="{{ $full.RelPermalink }}" width="800" height="800" style="display:block; width:100%; height:auto;" alt="{{ .Params.alt }}" title='{{ .Title }} ({{ .Date| time.Format "2006" }}) by Ben Young'>
                        </div>
                        
                        <br class="clear" style="clear:both;">

                        <div class="info" style="font-size:0.5em; width:100%; line-height:1.5em;">
                          <div class="author" style="float:left; text-align:left; width:50%; padding:0 0.5em;">
                            <strong class="title" style="font-size:1.2em;">
                              {{ .Params.author | default .Site.Params.author }}
                            </strong>
                            <br>
                            American, 1990 - Current
                          </div>

                          <div class="description" style="float:right; text-align:right; width:50%; padding:0 0.5em;">
                            <span class="title" style="font-size:1.2em;">
                              <strong>
                                {{ .Title }}
                              </strong>
                              (
                              <em>
                                {{ .Date | time.Format (default "2006" .Site.Params.date_format) }}
                              </em>
                              )
                            </span>
                            <br>
                            {{ title (index (.Params.mediums) 0) }} on {{ title (index (.Params.materials) 0) }}
                          </div>
                        </div>

                        <br class="clear" style="clear:both;">
                      </div>
                    </div>
                  </div>
                </a>

                <br>

              </section>
            {{ end }}

            <article>
              {{ if .Resources.GetMatch "painting.jpg" }}
                <h2 id="about">
                  About the {{ .Title }} Painting
                </h2>
              {{ end }}

              <p>
                {{ if not .Date.IsZero }}
                  <time class="date" {{ printf `datetime="%s"` (.Date.Format "2006-01-02T15:04:05Z07:00") | safeHTMLAttr }}>
                    <em>{{- .Date | time.Format (default "January 2, 2006" .Site.Params.date_format) -}}</em>
                  </time>
                {{ end }}
              </p>

              {{- .Content -}}

              {{ if or (eq .Params.status "sale") (eq .Params.status "sold") }}
                <div id="purchase" class="box clear" style="background-color: #eee;">
                  <h2 style="text-align: center;">Purchase {{ .Title }}</h2>
                  
                  {{ if eq .Params.status "sold" }}
                    <p>
                      The original of this painting has been sold and is no longer available for sale.
                      You may still view the product page for archival reasons, link below.
                    </p>
                  {{ end }}

                  {{ if gt .Params.limited 0 }}
                    <p>
                      Prints and framed prints for this artwork are limited to {{ .Params.limited }}, total to be sold for purchase.
                      You may find how much are left in inventory on the limited print product page, link below.
                    </p>
                  {{ end }}

                  <div class="row" style="text-align: center;">
                    {{ range $product := .Params.products }}
                      <div class="col-4 col-12-small">
                        <div class="ecsp ecsp-SingleProduct-v2 ecsp-SingleProduct-v2-bordered ecsp-SingleProduct-v2-centered ecsp-Product ec-Product-{{ $product.id }}" itemscope itemtype="http://schema.org/Product" data-single-product-id="{{ $product.id }}" style="display:inline-block; background-color:#fff;">
                          <div itemprop="image"></div>
                          <div class="ecsp-title" itemprop="name" content="{{ $product.name }}"></div>
                          <div itemtype="http://schema.org/Offer" itemscope itemprop="offers">
                            <div class="ecsp-productBrowser-price ecsp-price" itemprop="price" content="{{ $product.price }}">
                              <div itemprop="priceCurrency" content="USD"></div>
                            </div>
                          </div>
                        </div>

                        <a class="button fit primary clear" href="/shop/#!/p/{{ $product.id }}">
                          View {{ $product.name }}
                        </a>
                        <br>
                        <br>
                      </div>
                    {{ end }}
                  </div>

                  <script data-cfasync="false" type="text/javascript" src="https://app.ecwid.com/script.js?101772706&data_platform=singleproduct_v2" charset="utf-8"></script>
                  <script type="text/javascript">
                    document.addEventListener("DOMContentLoaded", () => {
                      xProduct();
                    });
                  </script>
                </div>
              {{ end }}

              {{ if .Params.progress}}
                <div>
                  <h3>Artwork Process</h3>
                  <p>{{ .Params.progress }}</p>

                  {{ if .Page.Resources.Match "process/*.jpg" }}
                    <p>Here is a visual overview of the process:</p>
                    <ul style="list-style:none; text-align:center; margin-bottom:0;">
                      {{ with $files := .Page.Resources.Match "process/*.jpg" }}
                          {{ range $index, $file := $files }}
                              {{ $full := $file.Fit "800x800" }}
                              {{ $thumbnail := $file.Fill "90x90 Center q85" }}
                              <li style="display:inline-block;">
                                  <a class="preview" href="{{ $full.RelPermalink }}" data-gall="progress">
                                      <img style="background: #000 url('/images/loader.gif') center no-repeat;" src="{{ $thumbnail.RelPermalink }}" width="90px" height="90px" loading="lazy" alt="Progress step {{ add $index 1 }}" title="Progress step {{ add $index 1 }}">
                                      <br>
                                      Step {{ add $index 1 }}
                                  </a>
                              </li>
                          {{ end }}
                      {{ end }}
                    </ul>
                    {{ end }}
                </div>
              {{ end }}

              <br>

              {{ if .Params.location }}
                <div>
                  <h3>Scene Location Information</h3>
                  <p>{{ .Params.location }}</p>
                </div>
              {{ end }}

              {{ if in .Params.locations "patina" }}
                <h3>Where To Visit</h3>
                <p>This painting is currently on display at <a href="https://www.patinaartscentre.com">Patina Art Centre</a> in Canton Ohio, and can be viewed there.</p>
              {{ end }}

              {{ if in .Params.locations "massmu" }}
                <h3>Where To Visit</h3>
                <p>This painting is currently on display at <a href="https://www.massillonmuseum.org">Massillon Museum</a> in Massillon Ohio, and can be viewed there.</p>
              {{ end }}

              {{ if .Resources.GetMatch "painting.jpg" }}
                <h3>Tags</h3>
                <p>
                  {{- partial "tags.html" . -}}
                </p>
              {{ end }}
            </article>

            <br>

            <div class="next-post" style="float:left;">
              {{ if .NextPage }}
                <a class="link-reverse" href="{{ .NextPage.Permalink }}#main">« {{ .NextPage.Title | truncate 50 "..." }}</a>
              {{ end }}
            </div>
            
            <div class="previous-post" style="float:right;">
              {{ if .PrevPage }}
                <a class="link-reverse" href="{{ .PrevPage.Permalink }}#main">{{ .PrevPage.Title | truncate 50 "..."}} »</a>
              {{ end }}
            </div>
        </section>

        {{ if .Resources.GetMatch "painting.jpg" }}
          <aside class="w-30-l mt6-l">
            {{- partial "menu-contextual.html" . -}}

            <p style="text-align:center;"><strong><a href="/artwork#main">View All Artwork &gt;</a></strong></p>
          </aside>
        {{ end }}
    </div>

    {{ block "footer" . }}
      {{ partialCached "inside-footer.html" . }}
    {{ end }}
  </div>
  
{{ end }}
